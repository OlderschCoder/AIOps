{
  "__inputs": [
    { "name": "DS_INFLUXDB", "label": "InfluxDB", "type": "datasource", "pluginId": "influxdb", "pluginName": "InfluxDB" }
  ],
  "__requires": [
    { "type": "grafana", "id": "grafana", "name": "Grafana", "version": "10.x" },
    { "type": "panel", "id": "stat", "name": "Stat", "version": "8.0" },
    { "type": "panel", "id": "timeseries", "name": "Time series", "version": "8.0" },
    { "type": "panel", "id": "gauge", "name": "Gauge", "version": "8.0" }
  ],
  "title": "SCCC Power & Environment (LCARS)",
  "timezone": "browser",
  "schemaVersion": 37,
  "style": "dark",
  "tags": ["LCARS", "Environment"],
  "templating": { "list": [ { "type": "custom", "name": "location", "query": "MainDC,IDF1,IDF2,Library,Admin,Science,Gym", "includeAll": true, "multi": true } ] },
  "time": { "from": "now-7d", "to": "now" },
  "panels": [
    {
      "type": "gauge",
      "title": "Temperature (Â°C) by Location (placeholder)",
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 0 },
      "fieldConfig": { "defaults": { "unit": "celsius", "thresholds": { "mode": "absolute", "steps": [ { "color": "green" }, { "color": "yellow", "value": 27 }, { "color": "red", "value": 32 } ] } } },
      "datasource": { "type": "influxdb", "uid": "${DS_INFLUXDB}" },
      "targets": [
        { "refId": "A", "queryType": "flux", "query": "from(bucket: \"telegraf\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"environment\" and r._field == \"temperature_c\")\n  |> filter(fn: (r) => contains(value: r.location, set: v.location))\n  |> aggregateWindow(every: 10m, fn: last, createEmpty: false)" }
      ]
    },
    {
      "type": "gauge",
      "title": "Humidity (%) by Location (placeholder)",
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 0 },
      "fieldConfig": { "defaults": { "unit": "percent", "thresholds": { "mode": "absolute", "steps": [ { "color": "red", "value": 20 }, { "color": "green", "value": 40 }, { "color": "yellow", "value": 60 }, { "color": "red", "value": 80 } ] } } },
      "datasource": { "type": "influxdb", "uid": "${DS_INFLUXDB}" },
      "targets": [
        { "refId": "A", "queryType": "flux", "query": "from(bucket: \"telegraf\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"environment\" and r._field == \"humidity\")\n  |> filter(fn: (r) => contains(value: r.location, set: v.location))\n  |> aggregateWindow(every: 10m, fn: last, createEmpty: false)" }
      ]
    },
    {
      "type": "timeseries",
      "title": "Power Sensor State (placeholder)",
      "gridPos": { "h": 10, "w": 24, "x": 0, "y": 8 },
      "fieldConfig": { "defaults": { "unit": "short" } },
      "datasource": { "type": "influxdb", "uid": "${DS_INFLUXDB}" },
      "targets": [
        { "refId": "A", "queryType": "flux", "query": "from(bucket: \"telegraf\")\n  |> range(start: v.timeRangeStart, stop: v.timeRangeStop)\n  |> filter(fn: (r) => r._measurement == \"power\" and r._field == \"state\")\n  |> aggregateWindow(every: 5m, fn: last, createEmpty: false)" }
      ]
    }
  ]
}


