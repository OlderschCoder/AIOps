###############################################################################

#                            GLOBAL AGENT CONFIGURATION                       #

###############################################################################

[agent]

  interval = "60s"

  round_interval = true


  metric_batch_size = 1000

  metric_buffer_limit = 10000


  flush_interval = "20s"

  flush_jitter   = "5s"


  collection_jitter = "5s"

  precision = ""

  hostname = ""

  omit_hostname = false


  # Use gosmi so numeric OIDs work without local MIB files

  snmp_translator = "gosmi"


###############################################################################

#                             OUTPUT PLUGINS                                  #

###############################################################################

[[outputs.influxdb_v2]]

  urls          = ["http://10.0.0.22:8086"]

  token         = "FJyv2E4WC_xNxF41zPvWCB4bYHEHD_lZ3R1sKv4Gfzc1HcPAMz-UQGkcMMD4-_mriZvDXNVAz-ERPcJfjBXXIA=="

  organization  = "SCCC"

  bucket        = "telegraf"

  timeout       = "30s"
  flush_interval = "20s"
  metric_batch_size = 1000
  metric_buffer_limit = 200000
  content_encoding = "gzip"


###############################################################################

#                             INPUT PLUGINS                                   #

###############################################################################

# NOTE: ICMP/ping for building-to-building connectivity monitoring
# Internet latency/loss monitoring comes from FortiGate health checks.

###############################################################################
# Ping monitoring for building switches (building-to-building connectivity)
###############################################################################
[[inputs.ping]]
  urls = [
    # Core switches
    "192.168.2.70",  # sw-aa144-A48
    "192.168.2.71",  # sw-aa144-A24
    "192.168.2.72",  # Additional core
    "192.168.2.73",  # Additional core
    
    # Administrative Buildings
    "192.168.2.199",  # SWA-AA105
    "192.168.2.201",  # SW-A144-1-aruba
    "192.168.2.202",  # SW-A144-2-Aruba
    
    # Academic Buildings
    "192.168.2.196",  # SW-B101-Aruba (Boiler Room)
    "192.168.2.171",  # SW-COS109-Aruba (Cosmetology)
    
    # Student Living
    "192.168.2.175",  # SWA-SLC151
    "192.168.2.179",  # SWA-SLG
    "192.168.2.181",  # SWA-SLJ
    "192.168.2.182",  # SWA-SLR
    "192.168.2.183",  # SWA-SLS
    "192.168.2.184",  # SWA-SLT
    
    # Additional Facilities
    "192.168.2.200",  # SWA-SU121 (Student Union)
    "192.168.2.204",  # SW-SoftBallPB
    "192.168.2.205",  # SW-M201-1 (Maintenance)
  ]
  method = "native"  # Use "exec" on Windows if native doesn't work
  count = 5
  ping_interval = 1.0
  timeout = 3.0
  deadline = 10
  
  [inputs.ping.tags]
    monitoring_type = "building_connectivity"


###############################################################################

# SNMP – Aruba 6300 Switches (numeric OIDs only)

###############################################################################

[[inputs.snmp]]

  # Poll less aggressively to avoid "collection took longer" warnings.

  interval = "60s"

  timeout  = "5s"

  retries  = 2


  agents = [

    "udp://192.168.2.196:161", "udp://192.168.2.201:161", "udp://192.168.2.1:161",

    "udp://192.168.2.40:161",  "udp://192.168.2.171:161", "udp://192.168.2.175:161",

    "udp://192.168.2.179:161", "udp://192.168.2.181:161", "udp://192.168.2.182:161",

    "udp://192.168.2.183:161", "udp://192.168.2.184:161", "udp://192.168.2.186:161",

    "udp://192.168.2.187:161", "udp://192.168.2.188:161", "udp://192.168.2.189:161",

    "udp://192.168.2.190:161", "udp://192.168.2.195:161", "udp://192.168.2.199:161",

    "udp://192.168.2.200:161", "udp://192.168.2.202:161",

    "udp://192.168.2.203:161", "udp://192.168.2.204:161", "udp://192.168.2.205:161",

    "udp://192.168.2.212:161", "udp://10.70.1.1:161",    "udp://10.70.34.1:161"

  ]

  version = 3


  sec_name       = "MonitorUser"

  auth_protocol  = "SHA"

  auth_password  = "SecureAuth123"

  priv_protocol  = "AES"

  priv_password  = "SecurePriv456"

  sec_level      = "authPriv"


  max_repetitions = 25

  agent_host_tag  = "source"


  # System info

  [[inputs.snmp.field]]  # sysName

    oid  = "1.3.6.1.2.1.1.5.0"

    name = "sysName"

    is_tag = true


  [[inputs.snmp.field]]  # sysDescr

    oid  = "1.3.6.1.2.1.1.1.0"

    name = "sysDescr"
  
    is_tag = true


  [[inputs.snmp.field]]  # sysUpTime

    oid  = "1.3.6.1.2.1.1.3.0"

    name = "sysUpTime"


  [[inputs.snmp.field]]  # sysLocation

    oid  = "1.3.6.1.2.1.1.6.0"

    name = "sysLocation"

    is_tag = true


  # Optional legacy ifTable (32-bit)

  [[inputs.snmp.table]]

    name = "interface_legacy"

    oid  = "1.3.6.1.2.1.2.2"

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # ifDescr

      name   = "ifDescr"

      oid    = "1.3.6.1.2.1.2.2.1.2"

      is_tag = true


    [[inputs.snmp.table.field]]  # ifType

      name = "ifType"

      oid  = "1.3.6.1.2.1.2.2.1.3"


    [[inputs.snmp.table.field]]  # ifSpeed

      name = "ifSpeed"

      oid  = "1.3.6.1.2.1.2.2.1.5"


    [[inputs.snmp.table.field]]  # ifAdminStatus

      name = "ifAdminStatus"

      oid  = "1.3.6.1.2.1.2.2.1.7"


    [[inputs.snmp.table.field]]  # ifOperStatus

      name = "ifOperStatus"

      oid  = "1.3.6.1.2.1.2.2.1.8"


    [[inputs.snmp.table.field]]  # ifInOctets

      name = "ifInOctets"

      oid  = "1.3.6.1.2.1.2.2.1.10"


    [[inputs.snmp.table.field]]  # ifOutOctets

      name = "ifOutOctets"

      oid  = "1.3.6.1.2.1.2.2.1.16"


  # 64-bit interface counters and packet breakdown (numeric OIDs only)

  [[inputs.snmp.table]]

    name = "interface"

    oid  = "1.3.6.1.2.1.31.1.1.1"

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]

      name   = "ifName"

      oid    = "1.3.6.1.2.1.31.1.1.1.1"

      is_tag = true


    [[inputs.snmp.table.field]]

      name = "ifHighSpeed"

      oid  = "1.3.6.1.2.1.31.1.1.1.15"


    [[inputs.snmp.table.field]]

      name = "ifAlias"

      oid  = "1.3.6.1.2.1.31.1.1.1.18"


    [[inputs.snmp.table.field]]

      name = "ifHCInOctets"

      oid  = "1.3.6.1.2.1.31.1.1.1.6"

    [[inputs.snmp.table.field]]

      name = "ifHCOutOctets"

      oid  = "1.3.6.1.2.1.31.1.1.1.10"


    [[inputs.snmp.table.field]]

      name = "ifHCInUcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.7"

    [[inputs.snmp.table.field]]

      name = "ifHCOutUcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.11"


    [[inputs.snmp.table.field]]

      name = "ifHCInMulticastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.8"

    [[inputs.snmp.table.field]]

      name = "ifHCOutMulticastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.12"


    [[inputs.snmp.table.field]]

      name = "ifHCInBroadcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.9"

    [[inputs.snmp.table.field]]

      name = "ifHCOutBroadcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.13"


###############################################################################

# SNMP – FortiGate (Internet latency/loss via SD-WAN / link-monitor checks)

###############################################################################

[[inputs.snmp]]

  timeout         = "5s"

  retries         = 3

  max_repetitions = 25

  agent_host_tag  = "source"


  agents = ["udp://192.168.1.1:161"]

  version = 3


  sec_name       = "MonitorUser"

  auth_protocol  = "SHA"

  auth_password  = "StrongAuthPass@32456##"

  priv_protocol  = "AES"

  priv_password  = "StrongPrivPass@32456##"

  sec_level      = "authPriv"


  # System info

  [[inputs.snmp.field]]  # sysName

    oid  = "1.3.6.1.2.1.1.5.0"

    name = "sysName"

    is_tag = true


  [[inputs.snmp.field]]  # sysDescr

    oid  = "1.3.6.1.2.1.1.1.0"

    name = "sysDescr"
  
    is_tag = true


  [[inputs.snmp.field]]  # sysUpTime

    oid  = "1.3.6.1.2.1.1.3.0"

    name = "sysUpTime"


  # FortiGate summary

  [[inputs.snmp.field]]

    name = "fgSysSesCount"

    oid  = "1.3.6.1.4.1.12356.101.4.1.2.0"

  [[inputs.snmp.field]]

    name = "fgSysCpuUsage"

    oid  = "1.3.6.1.4.1.12356.101.4.1.3.0"

  [[inputs.snmp.field]]

    name = "fgSysMemUsage"

    oid  = "1.3.6.1.4.1.12356.101.4.1.4.0"


  # FortiGate interfaces (64-bit ifXTable)

  [[inputs.snmp.table]]

    name = "interface"

    oid  = "1.3.6.1.2.1.31.1.1.1"

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]

      name   = "ifName"

      oid    = "1.3.6.1.2.1.31.1.1.1.1"

      is_tag = true

    [[inputs.snmp.table.field]]

      name = "ifHCInOctets"

      oid  = "1.3.6.1.2.1.31.1.1.1.6"

    [[inputs.snmp.table.field]]

      name = "ifHCOutOctets"

      oid  = "1.3.6.1.2.1.31.1.1.1.10"

    [[inputs.snmp.table.field]]

      name = "ifHighSpeed"

      oid  = "1.3.6.1.2.1.31.1.1.1.15"

    [[inputs.snmp.table.field]]

      name = "ifAlias"

      oid  = "1.3.6.1.2.1.31.1.1.1.18"

    [[inputs.snmp.table.field]]

      name = "ifHCInUcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.7"

    [[inputs.snmp.table.field]]

      name = "ifHCOutUcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.11"

    [[inputs.snmp.table.field]]

      name = "ifHCInMulticastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.8"

    [[inputs.snmp.table.field]]

      name = "ifHCOutMulticastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.12"

    [[inputs.snmp.table.field]]

      name = "ifHCInBroadcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.9"

    [[inputs.snmp.table.field]]

      name = "ifHCOutBroadcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.13"


  # SD-WAN / Link-Monitor Health Checks (loss/latency per target)

  # Use a new measurement name to avoid historical string-type conflicts in InfluxDB.

  [[inputs.snmp.table]]

    name         = "fortigate_healthcheck_v2"

    oid          = "1.3.6.1.4.1.12356.101.4.9.2.1"

    inherit_tags = ["sysName"]


    # Tags

    [[inputs.snmp.table.field]]

      name   = "hc_name"

      oid    = "1.3.6.1.4.1.12356.101.4.9.2.1.2"

      is_tag = true

    [[inputs.snmp.table.field]]

      name   = "ifName"

      oid    = "1.3.6.1.4.1.12356.101.4.9.2.1.14"

      is_tag = true

    [[inputs.snmp.table.field]]

      name   = "vdom"

      oid    = "1.3.6.1.4.1.12356.101.4.9.2.1.10"

      is_tag = true


    # Metrics

    [[inputs.snmp.table.field]]

      name = "packet_loss_pct"

      oid  = "1.3.6.1.4.1.12356.101.4.9.2.1.9"

    [[inputs.snmp.table.field]]

      name = "latency_ms"

      oid  = "1.3.6.1.4.1.12356.101.4.9.2.1.5"

    [[inputs.snmp.table.field]]

      name = "pkts_sent"

      oid  = "1.3.6.1.4.1.12356.101.4.9.2.1.7"

    [[inputs.snmp.table.field]]

      name = "pkts_recv"

      oid  = "1.3.6.1.4.1.12356.101.4.9.2.1.8"


###############################################################################

# SYSLOG (FortiGate denies/IPS) – unprivileged port to avoid bind issues

###############################################################################

[[inputs.syslog]]

  server = "udp4://:5514"

  best_effort = true


###############################################################################

# PROCESSORS

###############################################################################

# Ensure health-check numeric fields are stored as numbers (for mean/avg)

[[processors.converter]]

  namepass = ["fortigate_healthcheck_v2"]

  [processors.converter.fields]

    float = ["packet_loss_pct", "latency_ms"]

    integer = ["pkts_sent", "pkts_recv"]


# Parse a few useful tags out of FortiGate syslog lines









[[processors.regex]]


  namepass = ["syslog"]



  [[processors.regex.tags]]


    key = "message"


    pattern = ".*subtype=(\\S+)"


    replacement = "${1}"


    result_key = "subtype"



  [[processors.regex.tags]]


    key = "message"


    pattern = ".*eventtype=(\\S+)"


    replacement = "${1}"


    result_key = "eventtype"



  [[processors.regex.tags]]


    key = "message"


    pattern = ".*action=(\\S+)"


    replacement = "${1}"


    result_key = "action"



  [[processors.regex.tags]]


    key = "message"


    pattern = ".*src=(\\S+)"


    replacement = "${1}"


    result_key = "src_ip"



  [[processors.regex.tags]]


    key = "message"


    pattern = ".*attack(id)?=(\\S+)"


    replacement = "${2}"


    result_key = "attack"






    

###############################################################################

# SNMP – Cisco Nexus 9000 (numeric OIDs only)

###############################################################################


[[inputs.snmp]]

  interval        = "60s"

  timeout         = "5s"

  retries         = 2

  max_repetitions = 10

  agent_host_tag  = "source"


  agents =["udp://192.168.2.70:161", "udp://192.168.2.72:161", "udp://192.168.2.73:161"]

  

  version = 3

  sec_name      = "MonitorUser"

  auth_protocol = "SHA"

  auth_password = "StrongAuthPass@32456##"

  priv_protocol = "AES"

  priv_password = "StrongPrivPass@32456##"

  sec_level     = "authPriv"


  # Identity

  [[inputs.snmp.field]]  # sysName

    oid  = "1.3.6.1.2.1.1.5.0"

    name = "sysName"

    is_tag = true


  [[inputs.snmp.field]]  # sysDescr

    oid  = "1.3.6.1.2.1.1.1.0"

    name = "sysDescr"

    is_tag = true

  [[inputs.snmp.field]]  # sysUpTime

    oid  = "1.3.6.1.2.1.1.3.0"

    name = "sysUpTime"


  [[inputs.snmp.field]]  # sysLocation (optional)

    oid  = "1.3.6.1.2.1.1.6.0"

    name = "sysLocation"

    is_tag = true


  # Interfaces (64-bit counters)

  [[inputs.snmp.table]]

    name         = "interface"

    oid          = "1.3.6.1.2.1.31.1.1.1"

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # ifName (tag)

      name   = "ifName"

      oid    = "1.3.6.1.2.1.31.1.1.1.1"

      is_tag = true


    [[inputs.snmp.table.field]]  # ifAlias

      name = "ifAlias"

      oid  = "1.3.6.1.2.1.31.1.1.1.18"


    [[inputs.snmp.table.field]]  # ifHighSpeed

      name = "ifHighSpeed"

      oid  = "1.3.6.1.2.1.31.1.1.1.15"


    [[inputs.snmp.table.field]]  # throughput

      name = "ifHCInOctets"

      oid  = "1.3.6.1.2.1.31.1.1.1.6"


    [[inputs.snmp.table.field]]

      name = "ifHCOutOctets"

      oid  = "1.3.6.1.2.1.31.1.1.1.10"


    [[inputs.snmp.table.field]]  # packet breakdown

      name = "ifHCInUcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.7"


    [[inputs.snmp.table.field]]

      name = "ifHCOutUcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.11"


    [[inputs.snmp.table.field]]

      name = "ifHCInMulticastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.8"


    [[inputs.snmp.table.field]]

      name = "ifHCOutMulticastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.12"


    [[inputs.snmp.table.field]]

      name = "ifHCInBroadcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.9"


    [[inputs.snmp.table.field]]

      name = "ifHCOutBroadcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.13"


  # Interface status and errors (legacy ifTable, limited fields only)

  [[inputs.snmp.table]]

    name         = "if_status_errors"

    oid          = "1.3.6.1.2.1.2.2.1"

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # ifIndex

      name   = "ifIndex"

      oid    = "1.3.6.1.2.1.2.2.1.1"

      is_tag = true


    [[inputs.snmp.table.field]]  # ifDescr (tag for interface identification)

      name   = "ifDescr"

      oid    = "1.3.6.1.2.1.2.2.1.2"

      is_tag = true


    [[inputs.snmp.table.field]]  # ifAdminStatus

      name = "ifAdminStatus"

      oid  = "1.3.6.1.2.1.2.2.1.7"


    [[inputs.snmp.table.field]]  # ifOperStatus

      name = "ifOperStatus"

      oid  = "1.3.6.1.2.1.2.2.1.8"


    [[inputs.snmp.table.field]]  # errors/discards/unknown

      name = "ifInErrors"

      oid  = "1.3.6.1.2.1.2.2.1.14"


    [[inputs.snmp.table.field]]

      name = "ifOutErrors"

      oid  = "1.3.6.1.2.1.2.2.1.20"


    [[inputs.snmp.table.field]]

      name = "ifInDiscards"

      oid  = "1.3.6.1.2.1.2.2.1.13"


    [[inputs.snmp.table.field]]

      name = "ifOutDiscards"

      oid  = "1.3.6.1.2.1.2.2.1.19"


    [[inputs.snmp.table.field]]

      name = "ifInUnknownProtos"

      oid  = "1.3.6.1.2.1.2.2.1.15"


    [[inputs.snmp.table.field]]  # ifLastChange

      name = "ifLastChange"

      oid  = "1.3.6.1.2.1.2.2.1.9"


  # OSPF Neighbor Table (OSPF-MIB) - For routing protocol health monitoring

  [[inputs.snmp.table]]

    name         = "ospf_neighbor"

    oid          = "1.3.6.1.2.1.14.10.1"  # ospfNbrTable

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # Neighbor IP address

      name   = "ospfNbrIpAddr"

      oid    = "1.3.6.1.2.1.14.10.1.1"

      is_tag = true


    [[inputs.snmp.table.field]]  # Neighbor Router ID

      name   = "ospfNbrRtrId"

      oid    = "1.3.6.1.2.1.14.10.1.3"

      is_tag = true


    [[inputs.snmp.table.field]]  # Neighbor state (8 = Full)

      name = "ospfNbrState"

      oid  = "1.3.6.1.2.1.14.10.1.6"


    [[inputs.snmp.table.field]]  # Number of state changes

      name = "ospfNbrEvents"

      oid  = "1.3.6.1.2.1.14.10.1.7"


  # LACP Aggregate Port Table (IEEE 802.3ad) - For link aggregation monitoring

  [[inputs.snmp.table]]

    name         = "lacp_aggregate"

    oid          = "1.3.6.1.2.1.17.7.1.4.5.1"  # dot3adAggPortAttachedAggID

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # Aggregation group ID

      name   = "dot3adAggPortAttachedAggID"

      oid    = "1.3.6.1.2.1.17.7.1.4.5.1.3"

      is_tag = true


    [[inputs.snmp.table.field]]  # Actor state (bitmask)

      name = "dot3adAggPortActorState"

      oid  = "1.3.6.1.2.1.17.7.1.4.5.1.13"


    [[inputs.snmp.table.field]]  # Partner state

      name = "dot3adAggPortPartnerState"

      oid  = "1.3.6.1.2.1.17.7.1.4.5.1.14"


  # LLDP Remote Table - For topology discovery (which interfaces connect to which devices)

  [[inputs.snmp.table]]

    name         = "lldp_remote"

    oid          = "1.0.8802.1.1.2.1.4.1.1"  # lldpRemTable

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # Local port (maps to ifIndex)

      name   = "lldpRemLocalPortNum"

      oid    = "1.0.8802.1.1.2.1.4.1.1.2"

      is_tag = true


    [[inputs.snmp.table.field]]  # Remote chassis ID

      name   = "lldpRemChassisId"

      oid    = "1.0.8802.1.1.2.1.4.1.1.5"

      is_tag = true


    [[inputs.snmp.table.field]]  # Remote system name (building switch name!)

      name   = "lldpRemSysName"

      oid    = "1.0.8802.1.1.2.1.4.1.1.9"

      is_tag = true


    [[inputs.snmp.table.field]]  # Remote port description

      name   = "lldpRemPortDesc"

      oid    = "1.0.8802.1.1.2.1.4.1.1.8"

      is_tag = true


  # Cisco VPC (Virtual Port Channel) - Nexus specific (verify OIDs for your model/version)
  # NOTE: VPC OIDs may vary by Nexus model/version. Verify with: snmpwalk -v3 <auth> <device> 1.3.6.1.4.1.9.9.810
  [[inputs.snmp.table]]

    name         = "cisco_vpc"

    oid          = "1.3.6.1.4.1.9.9.810.1.1.1.1"  # cvpcVpcTable (verify OID for your model)

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # VPC ID

      name   = "cvpcVpcId"

      oid    = "1.3.6.1.4.1.9.9.810.1.1.1.1.1"  # Verify OID

      is_tag = true


    [[inputs.snmp.table.field]]  # VPC state (1=up, 2=down)

      name = "cvpcVpcState"

      oid  = "1.3.6.1.4.1.9.9.810.1.1.1.1.2"  # Verify OID


    [[inputs.snmp.table.field]]  # Peer status

      name = "cvpcVpcPeerStatus"

      oid  = "1.3.6.1.4.1.9.9.810.1.1.1.1.3"  # Verify OID


  # CPU (CISCO-PROCESS-MIB, *Rev counters*)

  [[inputs.snmp.table]]

    name         = "cisco_cpu"

    oid          = "1.3.6.1.4.1.9.9.109.1.1.1.1"

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]

      name = "cpmCPUTotal5secRev"

      oid  = "1.3.6.1.4.1.9.9.109.1.1.1.1.6"


    [[inputs.snmp.table.field]]

      name = "cpmCPUTotal1minRev"

      oid  = "1.3.6.1.4.1.9.9.109.1.1.1.1.7"


    [[inputs.snmp.table.field]]

      name = "cpmCPUTotal5minRev"

      oid  = "1.3.6.1.4.1.9.9.109.1.1.1.1.8"


  # Memory (CISCO-MEMORY-POOL-MIB)

  [[inputs.snmp.table]]

    name         = "cisco_memory_pool"

    oid          = "1.3.6.1.4.1.9.9.48.1.1.1"

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # Pool Name

      name   = "ciscoMemoryPoolName"

      oid    = "1.3.6.1.4.1.9.9.48.1.1.1.2"

      is_tag = true


    [[inputs.snmp.table.field]]  # Used Bytes

      name = "ciscoMemoryPoolUsed"

      oid  = "1.3.6.1.4.1.9.9.48.1.1.1.5"


    [[inputs.snmp.table.field]]  # Free Bytes

      name = "ciscoMemoryPoolFree"

      oid  = "1.3.6.1.4.1.9.9.48.1.1.1.6"


      
f
###############################################################################

# SNMP – Cisco Nexus 9000 (numeric OIDs only)

###############################################################################


[[inputs.snmp]]

  interval        = "60s"

  timeout         = "5s"

  retries         = 2

  max_repetitions = 10

  agent_host_tag  = "source"


  agents =["udp://192.168.2.71:161"]

  

  version = 3

  sec_name      = "MonitorUser"

  auth_protocol = "SHA"

  auth_password = "StrongAuthPass@4820517##"

  priv_protocol = "AES"

  priv_password = "StrongPrivPass@4820517##"

  sec_level     = "authPriv"


  # Identity

  [[inputs.snmp.field]]  # sysName

    oid  = "1.3.6.1.2.1.1.5.0"

    name = "sysName"

    is_tag = true


  [[inputs.snmp.field]]  # sysDescr

    oid  = "1.3.6.1.2.1.1.1.0"

    name = "sysDescr"

    is_tag = true 

  [[inputs.snmp.field]]  # sysUpTime

    oid  = "1.3.6.1.2.1.1.3.0"

    name = "sysUpTime"


  [[inputs.snmp.field]]  # sysLocation (optional)

    oid  = "1.3.6.1.2.1.1.6.0"

    name = "sysLocation"

    is_tag = true


  # Interfaces (64-bit counters)

  [[inputs.snmp.table]]

    name         = "interface"

    oid          = "1.3.6.1.2.1.31.1.1.1"

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # ifName (tag)

      name   = "ifName"

      oid    = "1.3.6.1.2.1.31.1.1.1.1"

      is_tag = true


    [[inputs.snmp.table.field]]  # ifAlias

      name = "ifAlias"

      oid  = "1.3.6.1.2.1.31.1.1.1.18"


    [[inputs.snmp.table.field]]  # ifHighSpeed

      name = "ifHighSpeed"

      oid  = "1.3.6.1.2.1.31.1.1.1.15"


    [[inputs.snmp.table.field]]  # throughput

      name = "ifHCInOctets"

      oid  = "1.3.6.1.2.1.31.1.1.1.6"


    [[inputs.snmp.table.field]]

      name = "ifHCOutOctets"

      oid  = "1.3.6.1.2.1.31.1.1.1.10"


    [[inputs.snmp.table.field]]  # packet breakdown

      name = "ifHCInUcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.7"


    [[inputs.snmp.table.field]]

      name = "ifHCOutUcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.11"


    [[inputs.snmp.table.field]]

      name = "ifHCInMulticastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.8"


    [[inputs.snmp.table.field]]

      name = "ifHCOutMulticastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.12"


    [[inputs.snmp.table.field]]

      name = "ifHCInBroadcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.9"


    [[inputs.snmp.table.field]]

      name = "ifHCOutBroadcastPkts"

      oid  = "1.3.6.1.2.1.31.1.1.1.13"


  # Interface status and errors (legacy ifTable, limited fields only)

  [[inputs.snmp.table]]

    name         = "if_status_errors"

    oid          = "1.3.6.1.2.1.2.2.1"

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # ifIndex

      name   = "ifIndex"

      oid    = "1.3.6.1.2.1.2.2.1.1"

      is_tag = true


    [[inputs.snmp.table.field]]  # ifDescr (tag for interface identification)

      name   = "ifDescr"

      oid    = "1.3.6.1.2.1.2.2.1.2"

      is_tag = true


    [[inputs.snmp.table.field]]  # ifAdminStatus

      name = "ifAdminStatus"

      oid  = "1.3.6.1.2.1.2.2.1.7"


    [[inputs.snmp.table.field]]  # ifOperStatus

      name = "ifOperStatus"

      oid  = "1.3.6.1.2.1.2.2.1.8"


    [[inputs.snmp.table.field]]  # errors/discards/unknown

      name = "ifInErrors"

      oid  = "1.3.6.1.2.1.2.2.1.14"


    [[inputs.snmp.table.field]]

      name = "ifOutErrors"

      oid  = "1.3.6.1.2.1.2.2.1.20"


    [[inputs.snmp.table.field]]

      name = "ifInDiscards"

      oid  = "1.3.6.1.2.1.2.2.1.13"


    [[inputs.snmp.table.field]]

      name = "ifOutDiscards"

      oid  = "1.3.6.1.2.1.2.2.1.19"


    [[inputs.snmp.table.field]]

      name = "ifInUnknownProtos"

      oid  = "1.3.6.1.2.1.2.2.1.15"


    [[inputs.snmp.table.field]]  # ifLastChange

      name = "ifLastChange"

      oid  = "1.3.6.1.2.1.2.2.1.9"


  # OSPF Neighbor Table (OSPF-MIB) - For routing protocol health monitoring

  [[inputs.snmp.table]]

    name         = "ospf_neighbor"

    oid          = "1.3.6.1.2.1.14.10.1"  # ospfNbrTable

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # Neighbor IP address

      name   = "ospfNbrIpAddr"

      oid    = "1.3.6.1.2.1.14.10.1.1"

      is_tag = true


    [[inputs.snmp.table.field]]  # Neighbor Router ID

      name   = "ospfNbrRtrId"

      oid    = "1.3.6.1.2.1.14.10.1.3"

      is_tag = true


    [[inputs.snmp.table.field]]  # Neighbor state (8 = Full)

      name = "ospfNbrState"

      oid  = "1.3.6.1.2.1.14.10.1.6"


    [[inputs.snmp.table.field]]  # Number of state changes

      name = "ospfNbrEvents"

      oid  = "1.3.6.1.2.1.14.10.1.7"


  # LACP Aggregate Port Table (IEEE 802.3ad) - For link aggregation monitoring

  [[inputs.snmp.table]]

    name         = "lacp_aggregate"

    oid          = "1.3.6.1.2.1.17.7.1.4.5.1"  # dot3adAggPortAttachedAggID

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # Aggregation group ID

      name   = "dot3adAggPortAttachedAggID"

      oid    = "1.3.6.1.2.1.17.7.1.4.5.1.3"

      is_tag = true


    [[inputs.snmp.table.field]]  # Actor state (bitmask)

      name = "dot3adAggPortActorState"

      oid  = "1.3.6.1.2.1.17.7.1.4.5.1.13"


    [[inputs.snmp.table.field]]  # Partner state

      name = "dot3adAggPortPartnerState"

      oid  = "1.3.6.1.2.1.17.7.1.4.5.1.14"


  # LLDP Remote Table - For topology discovery (which interfaces connect to which devices)

  [[inputs.snmp.table]]

    name         = "lldp_remote"

    oid          = "1.0.8802.1.1.2.1.4.1.1"  # lldpRemTable

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # Local port (maps to ifIndex)

      name   = "lldpRemLocalPortNum"

      oid    = "1.0.8802.1.1.2.1.4.1.1.2"

      is_tag = true


    [[inputs.snmp.table.field]]  # Remote chassis ID

      name   = "lldpRemChassisId"

      oid    = "1.0.8802.1.1.2.1.4.1.1.5"

      is_tag = true


    [[inputs.snmp.table.field]]  # Remote system name (building switch name!)

      name   = "lldpRemSysName"

      oid    = "1.0.8802.1.1.2.1.4.1.1.9"

      is_tag = true


    [[inputs.snmp.table.field]]  # Remote port description

      name   = "lldpRemPortDesc"

      oid    = "1.0.8802.1.1.2.1.4.1.1.8"

      is_tag = true


  # Cisco VPC (Virtual Port Channel) - Nexus specific (verify OIDs for your model/version)
  # NOTE: VPC OIDs may vary by Nexus model/version. Verify with: snmpwalk -v3 <auth> <device> 1.3.6.1.4.1.9.9.810
  [[inputs.snmp.table]]

    name         = "cisco_vpc"

    oid          = "1.3.6.1.4.1.9.9.810.1.1.1.1"  # cvpcVpcTable (verify OID for your model)

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # VPC ID

      name   = "cvpcVpcId"

      oid    = "1.3.6.1.4.1.9.9.810.1.1.1.1.1"  # Verify OID

      is_tag = true


    [[inputs.snmp.table.field]]  # VPC state (1=up, 2=down)

      name = "cvpcVpcState"

      oid  = "1.3.6.1.4.1.9.9.810.1.1.1.1.2"  # Verify OID


    [[inputs.snmp.table.field]]  # Peer status

      name = "cvpcVpcPeerStatus"

      oid  = "1.3.6.1.4.1.9.9.810.1.1.1.1.3"  # Verify OID


  # CPU (CISCO-PROCESS-MIB, *Rev counters*)

  [[inputs.snmp.table]]

    name         = "cisco_cpu"

    oid          = "1.3.6.1.4.1.9.9.109.1.1.1.1"

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]

      name = "cpmCPUTotal5secRev"

      oid  = "1.3.6.1.4.1.9.9.109.1.1.1.1.6"


    [[inputs.snmp.table.field]]

      name = "cpmCPUTotal1minRev"

      oid  = "1.3.6.1.4.1.9.9.109.1.1.1.1.7"


    [[inputs.snmp.table.field]]

      name = "cpmCPUTotal5minRev"

      oid  = "1.3.6.1.4.1.9.9.109.1.1.1.1.8"


  # Memory (CISCO-MEMORY-POOL-MIB)

  [[inputs.snmp.table]]

    name         = "cisco_memory_pool"

    oid          = "1.3.6.1.4.1.9.9.48.1.1.1"

    inherit_tags = ["sysName", "sysLocation"]


    [[inputs.snmp.table.field]]  # Pool Name

      name   = "ciscoMemoryPoolName"

      oid    = "1.3.6.1.4.1.9.9.48.1.1.1.2"

      is_tag = true


    [[inputs.snmp.table.field]]  # Used Bytes

      name = "ciscoMemoryPoolUsed"

      oid  = "1.3.6.1.4.1.9.9.48.1.1.1.5"


    [[inputs.snmp.table.field]]  # Free Bytes

      name = "ciscoMemoryPoolFree"

      oid  = "1.3.6.1.4.1.9.9.48.1.1.1.6"
